#!/bin/bash
# Post-commit hook to auto-update TASK.md
# This runs after every commit to check for task completions

set -e

echo "🔍 Checking for task completions..."

# Run the auto-updater script
if [ -f "scripts/auto_update_tasks.py" ]; then
    python3 scripts/auto_update_tasks.py
    
    # If TASK.md was updated, make an additional commit
    if git diff --quiet TASK.md; then
        echo "ℹ️  No TASK.md updates needed"
    else
        echo "📝 TASK.md was updated - creating follow-up commit"
        git add TASK.md
        git commit -m "auto: update TASK.md with completed criteria

🤖 Auto-generated by post-commit hook based on detected completions"
        echo "✅ TASK.md auto-update committed"
    fi
else
    echo "⚠️  Auto-updater script not found"
fi